<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
                      <html>
                    <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
                    <title>ProVerif: process 0</title>
                    <link rel="stylesheet" href="cssproverif.css">
                                                                           </head>
                                                                         <body>
                                                                         <H1>Process 0 (the initial process)</H1>
<a name=occ1 class="occ">{1}</a> <span class="keyword">new</span> <span class="name">Appkey</span>: <span class="type">key</span>;<br>
<a name=occ2 class="occ">{2}</a> <span class="keyword">new</span> <span class="name">NwkKey</span>: <span class="type">key</span>;<br>
<a name=occ3 class="occ">{3}</a> <span class="keyword">new</span> <span class="name">JoinEUI</span>: <span class="type">bitstring</span>;<br>
<a name=occ4 class="occ">{4}</a> <span class="keyword">new</span> <span class="name">DevEUI</span>: <span class="type">bitstring</span>;<br>
<a name=occ5 class="occ">{5}</a> <span class="keyword">new</span> <span class="name">DevNonce</span>: <span class="type">bitstring</span>;<br>
<a name=occ6 class="occ">{6}</a> <span class="keyword">new</span> <span class="name">DevAddr</span>: <span class="type">bitstring</span>;<br>
(<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ7 class="occ">{7}</a> <span class="keyword">let</span> <span class="var">AppKey</span>: <span class="type">key</span> = <span class="name">Appkey</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ8 class="occ">{8}</a> <span class="keyword">let</span> <span class="var">NwkKey_1</span>: <span class="type">key</span> = <span class="name">NwkKey</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ9 class="occ">{9}</a> <span class="keyword">let</span> <span class="var">JoinEUI_1</span>: <span class="type">bitstring</span> = <span class="name">JoinEUI</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ10 class="occ">{10}</a> <span class="keyword">let</span> <span class="var">DevEUI_1</span>: <span class="type">bitstring</span> = <span class="name">DevEUI</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ11 class="occ">{11}</a> <span class="keyword">let</span> <span class="var">DevNonce_1</span>: <span class="type">bitstring</span> = <span class="name">DevNonce</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ12 class="occ">{12}</a> <span class="keyword">let</span> <span class="var">tag1</span>: <span class="type">bitstring</span> = <span class="fun">mac</span>(<span class="fun"></span>(<span class="var">JoinEUI_1</span>,<span class="var">DevEUI_1</span>,<span class="var">DevNonce_1</span>),<span class="var">NwkKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ13 class="occ">{13}</a> <span class="keyword">out</span>(<span class="name">c</span>, <span class="fun"></span>(<span class="var">JoinEUI_1</span>,<span class="var">DevEUI_1</span>,<span class="var">DevNonce_1</span>,<span class="var">tag1</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ14 class="occ">{14}</a> <span class="keyword">in</span>(<span class="name">c</span>, <span class="var">ciphetext</span>: <span class="type">bitstring</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ15 class="occ">{15}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">JoinNonce</span>: <span class="type">bitstring</span>,<span class="var">Home_NetID</span>: <span class="type">bitstring</span>,<span class="var">DevAddr_1</span>: <span class="type">bitstring</span>,<span class="var">tag2</span>: <span class="type">bitstring</span>) = <span class="fun">sdec</span>(<span class="var">ciphetext</span>,<span class="var">NwkKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ16 class="occ">{16}</a> <span class="keyword">let</span> <span class="var">FNwkSIntKey</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="var">JoinNonce</span>,<span class="var">JoinEUI_1</span>,<span class="var">DevNonce_1</span>,<span class="fun">one</span>),<span class="var">NwkKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ17 class="occ">{17}</a> <span class="keyword">let</span> <span class="var">SnwkSIntKey</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="var">JoinNonce</span>,<span class="var">JoinEUI_1</span>,<span class="var">DevNonce_1</span>,<span class="fun">three</span>),<span class="var">NwkKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ18 class="occ">{18}</a> <span class="keyword">let</span> <span class="var">AppsKey</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="var">JoinNonce</span>,<span class="var">JoinEUI_1</span>,<span class="var">DevNonce_1</span>,<span class="fun">two</span>),<span class="var">NwkKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ19 class="occ">{19}</a> <span class="keyword">let</span> <span class="var">NwkSEncKey</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="var">JoinNonce</span>,<span class="var">JoinEUI_1</span>,<span class="var">DevNonce_1</span>,<span class="fun">four</span>),<span class="var">NwkKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ20 class="occ">{20}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ21 class="occ">{21}</a> <span class="keyword">new</span> <span class="name">FCntUp</span>: <span class="type">coins</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ22 class="occ">{22}</a> <span class="keyword">let</span> <span class="var">outCipher</span>: <span class="type">bitstring</span> = <span class="fun">senc</span>(<span class="fun"></span>(<span class="name">m</span>,<span class="name">FCntUp</span>),<span class="var">NwkSEncKey</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ23 class="occ">{23}</a> <span class="keyword">let</span> <span class="var">tag3</span>: <span class="type">bitstring</span> = <span class="fun">mac</span>(<span class="fun"></span>(<span class="var">DevAddr_1</span>,<span class="name">FCntUp</span>,<span class="name">m</span>),<span class="var">NwkSEncKey</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ24 class="occ">{24}</a> <span class="keyword">out</span>(<span class="name">c</span>, <span class="fun"></span>(<span class="var">outCipher</span>,<span class="var">tag3</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ25 class="occ">{25}</a> <span class="keyword">event</span> <span class="fun">endED</span><br>
) | (<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ26 class="occ">{26}</a> <span class="keyword">let</span> <span class="var">AppKey_1</span>: <span class="type">key</span> = <span class="name">Appkey</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ27 class="occ">{27}</a> <span class="keyword">let</span> <span class="var">NwkKey_2</span>: <span class="type">key</span> = <span class="name">NwkKey</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ28 class="occ">{28}</a> <span class="keyword">let</span> <span class="var">DevEUI_2</span>: <span class="type">bitstring</span> = <span class="name">DevEUI</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ29 class="occ">{29}</a> <span class="keyword">let</span> <span class="var">JoinEUI_2</span>: <span class="type">bitstring</span> = <span class="name">JoinEUI</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ30 class="occ">{30}</a> <span class="keyword">let</span> <span class="var">DevAddr_2</span>: <span class="type">bitstring</span> = <span class="name">DevAddr</span> <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ31 class="occ">{31}</a> <span class="keyword">out</span>(<span class="name">disclosureC</span>, <span class="var">NwkKey_2</span>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ32 class="occ">{32}</a> <span class="keyword">in</span>(<span class="name">c</span>, <span class="fun"></span>(=<span class="var">JoinEUI_2</span>,=<span class="var">DevEUI_2</span>,<span class="var">DevNonce_2</span>: <span class="type">bitstring</span>,<span class="var">tag</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ33 class="occ">{33}</a> <span class="keyword">if</span> (<span class="fun">mac</span>(<span class="fun"></span>(<span class="var">JoinEUI_2</span>,<span class="var">DevEUI_2</span>,<span class="var">DevNonce_2</span>),<span class="var">NwkKey_2</span>) <span class="fun">=</span> <span class="var">tag</span>) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ34 class="occ">{34}</a> <span class="keyword">new</span> <span class="name">JoinNonce_1</span>: <span class="type">bitstring</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ35 class="occ">{35}</a> <span class="keyword">new</span> <span class="name">Home_NetID_1</span>: <span class="type">bitstring</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ36 class="occ">{36}</a> <span class="keyword">let</span> <span class="var">tag2_1</span>: <span class="type">bitstring</span> = <span class="fun">mac</span>(<span class="fun"></span>(<span class="name">JoinNonce_1</span>,<span class="name">Home_NetID_1</span>,<span class="var">DevAddr_2</span>),<span class="var">NwkKey_2</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ37 class="occ">{37}</a> <span class="keyword">out</span>(<span class="name">c</span>, <span class="fun">senc</span>(<span class="fun"></span>(<span class="name">JoinNonce_1</span>,<span class="name">Home_NetID_1</span>,<span class="var">DevAddr_2</span>,<span class="var">tag2_1</span>),<span class="var">NwkKey_2</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ38 class="occ">{38}</a> <span class="keyword">let</span> <span class="var">FNwkSIntKey_1</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="name">JoinNonce_1</span>,<span class="var">JoinEUI_2</span>,<span class="var">DevNonce_2</span>,<span class="fun">one</span>),<span class="var">NwkKey_2</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ39 class="occ">{39}</a> <span class="keyword">let</span> <span class="var">SnwkSIntKey_1</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="name">JoinNonce_1</span>,<span class="var">JoinEUI_2</span>,<span class="var">DevNonce_2</span>,<span class="fun">three</span>),<span class="var">NwkKey_2</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ40 class="occ">{40}</a> <span class="keyword">let</span> <span class="var">AppsKey_1</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="name">JoinNonce_1</span>,<span class="var">JoinEUI_2</span>,<span class="var">DevNonce_2</span>,<span class="fun">two</span>),<span class="var">NwkKey_2</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ41 class="occ">{41}</a> <span class="keyword">let</span> <span class="var">NwkSEncKey_1</span>: <span class="type">key</span> = <span class="fun">KgenSenc</span>(<span class="fun"></span>(<span class="name">JoinNonce_1</span>,<span class="var">JoinEUI_2</span>,<span class="var">DevNonce_2</span>,<span class="fun">four</span>),<span class="var">NwkKey_2</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ42 class="occ">{42}</a> <span class="keyword">!</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ43 class="occ">{43}</a> <span class="keyword">in</span>(<span class="name">c</span>, <span class="fun"></span>(<span class="var">cipher</span>: <span class="type">bitstring</span>,<span class="var">tag3_1</span>: <span class="type">bitstring</span>));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ44 class="occ">{44}</a> <span class="keyword">let</span> <span class="fun"></span>(<span class="var">plaintext2</span>: <span class="type">bitstring</span>,<span class="var">FCntUp_1</span>: <span class="type">coins</span>) = <span class="fun">sdec</span>(<span class="var">cipher</span>,<span class="var">NwkSEncKey_1</span>) <span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ45 class="occ">{45}</a> <span class="keyword">if</span> (<span class="var">tag3_1</span> <span class="fun">=</span> <span class="fun">mac</span>(<span class="fun"></span>(<span class="var">DevAddr_2</span>,<span class="var">FCntUp_1</span>,<span class="var">plaintext2</span>),<span class="var">NwkSEncKey_1</span>)) <span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a name=occ46 class="occ">{46}</a> <span class="keyword">event</span> <span class="fun">endJS</span><br>
)<br>
<br>
</body>
</html>
